# 2021年西湖论剑CTF—— Crypto —— SpecialCurve2

题目见`SpecialCurve2.py`

题目中说是一条曲线，但是分析一下发现x轴和y轴坐标实际上对应的是复数域中的实部和虚部，然后运算就是复数的乘法运算。因此题目中要我们求的相当于是复数域上的离散对数问题。然后又因为这个复数域的生成元是$1+i$这个特殊的形式，它为基生成的元素可以和一个阶为$4(p-1)$的整数乘法群同构。但是我们可以使用另一种方法进行求解。就是对群中的元素取模长，然后模$p$。这种情况下就相当于$|x^2+y^2|\ mod\ p$，即控制了角度，也控制了长度，因此同样会同构于一个模$p$的乘法群。只需要求这个实数上的乘法群的离散对数问题即可。

由于乘法群的阶是88比特的，因此有两种方法可以进行求解，一种是使用cado-nfs求解离散对数，分别求出三个的离散对数，然后使用中国剩余定理求解。另一种是使用Sagemath中的`.log`函数来计算。

* 参考资料：https://zhuanlan.zhihu.com/p/436496753