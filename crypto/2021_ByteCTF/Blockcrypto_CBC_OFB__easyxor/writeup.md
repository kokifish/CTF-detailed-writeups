# 2021年ByteCTF—— Crypto —— easyxor

题目见`easyxor.py`

题目主要是使用两种块加密的方式进行设计，使用CBC和OFB模式，但是加密的方式仅仅为移位异或。

* 核心题解：因为加密方案是移位异或，因此经简单推导可以写出其逆函数，不同人的逆函数写得不一样，但是第二篇参考资料写的逆函数最为简洁。然后可以通过CBC或者OFB的漏洞，根据明文一定是可显示字符或者明文的某些bit一定是固定字符破解出密钥，然后根据OFB模式已知第一组的明文为`ByteCTF{`和破解出的密钥恢复出`iv`，这样`key`和`iv`都知道了就可以恢复出明文。

* 题解1：官方解法，使用OFB模式的漏洞，根据`ByteCTF{`与第一组密文进行异或得到第二组进行加密的数据，然后因为明文都是可显示字符，因此可以通过这种方式进行暴力破解key，然后key得到之后就能恢复出`iv`。

* 题解2：根据CBC模式的第二块和第三块的关系，因为最后一个明文字符一定是`}`或者是以`}`结尾，因此可以通过这种方式暴力破解`key`，然后通过上面的核心题解求解出`iv`。


* 参考资料：
    * https://bytectf.feishu.cn/docs/doccnq7Z5hqRBMvrmpRQMAGEK4e#
    * https://blog.csdn.net/m0_57291352/article/details/120935264